<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>저는 라이어입니다.</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            position: relative;
        }

        canvas {
            border: 1px solid white;
            display: block;
            margin: 20px auto;
            position: relative;
            z-index: 2;
            /* 캔버스를 이미지 위에 배치 */
        }

        .background-image {
            position: absolute;
            top: 50px;
            /* 캔버스와 정렬을 위해 조정 */
            left: 50%;
            transform: translateX(-50%);
            width: 550px;
            /* 캔버스와 동일한 크기 */
            height: 620px;
            z-index: 1;
            /* 이미지를 캔버스 아래로 설정 */
            pointer-events: none;
            /* 이미지를 클릭할 수 없도록 설정 */
        }

        .color-palette {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }

        .color-block {
            width: 30px;
            height: 30px;
            margin: 0 5px;
            border: 1px solid black;
            cursor: pointer;
        }

        .black {
            background-color: black;
        }

        .blue {
            background-color: blue;
        }

        .red {
            background-color: red;
        }
    </style>
</head>

<body>
    <h1 style="text-align: center;">저는 라이어 입니다. 모두를 속이세요.</h1>
    <div class="color-palette">
        <div class="color-block black" data-color="black"></div>
        <div class="color-block blue" data-color="blue"></div>
        <div class="color-block red" data-color="red"></div>
    </div>

    <!-- 배경 이미지 -->
    <img src="./images/canvas.png" class="background-image" alt="배경 이미지">

    <!-- 캔버스 -->
    <canvas id="drawingCanvas" width="500" height="500"></canvas>
    <button id="nextPersonBtn" style="display: block; margin: 20px auto;">다음 사람</button>

    <script>
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;


        // 기본 선 색상 설정
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.strokeStyle = 'black';

        // 마우스 이벤트 설정
        canvas.addEventListener('mousedown', (e) => {
            drawing = true;
            ctx.beginPath();
            const rect = canvas.getBoundingClientRect();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            ctx.lineTo(x, y);
            ctx.stroke();
        });

        canvas.addEventListener('mouseup', () => {
            drawing = false;
        });

        canvas.addEventListener('mouseout', () => {
            drawing = false;
        });

        // 색상 블록 클릭 이벤트
        const colorBlocks = document.querySelectorAll('.color-block');
        colorBlocks.forEach((block) => {
            block.addEventListener('click', () => {
                const selectedColor = block.getAttribute('data-color');
                ctx.strokeStyle = selectedColor;
            });
        });

        // 다음 사람 버튼
        document.getElementById('nextPersonBtn').addEventListener('click', () => {
            const imageData = canvas.toDataURL(); // 그림을 데이터 URL로 변환
            localStorage.setItem('savedDrawing', imageData); // 로컬 스토리지에 저장
            alert('그림이 저장되었습니다! user1 페이지로 이동합니다.');

            // 버튼 숨기기
            document.getElementById('nextPersonBtn').style.display = 'none';
        });
    </script>
</body>

</html>